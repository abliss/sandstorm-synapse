(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1588:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var o=n(5),a=n.n(o),s=n(0),r=n.n(s),i=n(3),c=n(2),l=n.n(c),u=n(1),m=n(9),d=n(48),h=n(51);class p extends r.a.Component{constructor(e){super(e),a()(this,"_onDisable",async()=>{m.a.createTrackedDialogAsync("Disable message search","Disable message search",n.e(14).then(n.bind(null,1581)),null,null,!1,!0)}),a()(this,"_onDone",()=>{this.props.onFinished(!0)}),this.state={eventIndexSize:0,eventCount:0,roomCount:0,currentRoom:null}}async updateCurrentRoom(e){const t=h.a.get(),n=await t.getStats();let o=null;e&&(o=e.name),this.setState({eventIndexSize:n.size,roomCount:n.roomCount,eventCount:n.eventCount,currentRoom:o})}componentWillUnmount(){const e=h.a.get();null!==e&&e.removeListener("changedCheckpoint",this.updateCurrentRoom.bind(this))}async componentWillMount(){let e=0,t=0,n=0,o=null;const a=h.a.get();if(null!==a){a.on("changedCheckpoint",this.updateCurrentRoom.bind(this));const s=await a.getStats();e=s.size,t=s.roomCount,n=s.eventCount;const r=a.currentRoom();r&&(o=r.name)}this.setState({eventIndexSize:e,eventCount:n,roomCount:t,currentRoom:o})}render(){let e;e=null===this.state.currentRoom?Object(u.a)("Not currently downloading messages for any room."):Object(u.a)("Downloading mesages for %(currentRoom)s.",{currentRoom:this.state.currentRoom});const t=r.a.createElement("div",null,Object(u.a)("Riot is securely caching encrypted messages locally for them to appear in search results:"),r.a.createElement("div",{className:"mx_SettingsTab_subsectionText"},Object(u.a)("Space used:")," ",Object(d.a)(this.state.eventIndexSize,0),r.a.createElement("br",null),Object(u.a)("Indexed messages:")," ",Object(d.d)(this.state.eventCount),r.a.createElement("br",null),Object(u.a)("Number of rooms:")," ",Object(d.d)(this.state.roomCount),r.a.createElement("br",null),e,r.a.createElement("br",null))),n=i.a("views.dialogs.BaseDialog"),o=i.a("views.elements.DialogButtons");return r.a.createElement(n,{className:"mx_ManageEventIndexDialog",onFinished:this.props.onFinished,title:Object(u.a)("Message search")},t,r.a.createElement(o,{primaryButton:Object(u.a)("Done"),onPrimaryButtonClick:this.props.onFinished,primaryButtonClass:"primary",cancelButton:Object(u.a)("Disable"),onCancel:this._onDisable,cancelButtonClass:"danger"}))}}a()(p,"propTypes",{onFinished:l.a.func.isRequired})}}]);